# 리스트 컴프리헨션(List Comprehension)



 리스트 컴프리헨션은 직관적으로 리스트를 생성하는 방법이다. **대괄호 "[", "]"로 감싸고 내부에 for문과 if 문을 사용하여 반복하며 조건에 만족하는 것만 리스트로 생성**할 수 있다.

 **리스트 컴프리헨션을 사용하는 큰 이유는 직관적이고, 여러줄 쓸걸 한줄에 만들어 주기 때문이다.** 심지어 속도도 더 빠르다.

### 1. 기초 사용법

리스트 컴프리헨션을 쓰지 않고, 0부터 4사이의 정수로 리스트 생성한 경우

```python
list = []
for i in range(5):
	list.append(i)
    
>>>[0, 1, 2, 3, 4]
```



리스트 컴프리헨션을 이용하면 한줄에 처리가 가능

```python
[i for i in range(5)]

>>>[0, 1, 2, 3, 4]
```



```python
list(range(5))
>>>[0, 1, 2, 3, 4]
```

리스트 컴프리헨션을 쓰지 않고, 위와 같은 코드로도 0과 4 사이의 정수를 리스트로 만들 수 있다.

이 방법이 더 효율적이다. 하지만, **리스트 컴프리헨션을 사용하는 이유는 대괄호 내에서 수식이나 함수 적용뿐만 아니라, if - else문으로 조건을 자유롭게 줄 수 있다는 점**이다.



### 2. 응용

#### 1. 수식이나 함수 적용

​	1) 수식 적용

```python
[i * 10 for i in range(5)]

>>>[0, 10, 20, 30 ,40]
```

​	변수 i가 0 ~ 4까지 반복하며 10을 곱해, 0부터 40을 출력



​	2) 함수 적용

```python
def test(x):
    x = str(x)+'ab'
    return x
 
[test(i) for i in range(5)]

>>>['0ab', '1ab', '2ab', '3ab', '4ab']
```

​	test함수: x를 입력받아 문자열로 바꾼 뒤 ab를 추가하여 반환해주는 함수

​	[test(i) for i in range(5)] : 0과 4 사이의 수를 test함수에 넣고 반환한 값을 리스트로 생성



​	위처럼, 리스트 컴프리헨션에서는 리스트로 만들고자 하는 값에 함수도 적용할 수 있다.

​	(**수식이나 함수뿐만 아니라 변환되는 모든 것을 다 적용할 수 있다.**)

#### 2. 조건문 사용

사실 **list 컴프리헨션을 쓰다 보면 이 조건문을 쓰는 게 매우 편리하다.** 조건문은 리스트 컴프리헨션에서 왼쪽에 	쓸 수도 있고, 오른쪽에 쓸 수도 있다. **if문만 쓸 때는 오른쪽**에, **if else문을 쓸때는 왼쪽**에 쓴다.



 1) 오른쪽에 if문 사용

```python
[i for i in range(5) if i%2==0]

>>> [0, 2, 4]

[i for i in range(5) if i%2==0 if i%4==0] # if문을 여러 개 사용할 수 있다.
>>> [0, 4]
```

 2) 왼쪽에 if문 사용

 왼쪽에 if문을 사용할 때는 반드시 else와 같이 사용해야 합니다.

```python
[i if i%2==0 else 'odd' for i in range(5)]

>>> [0, 'odd', 2, 'odd', 4]
```

왼쪽에 i if i%2==0 else 'odd'는 i가 2로 나누어 떨어질 때는 i를 출력하고, 그렇지 않을 때는 'odd'를 출력하라는 의미이다. 즉, 2로 나누어 떨어지는 0, 2, 4에 대해선 그대로 출력하고, 2로 나누어 떨어지지 않는 1과 3에 대해 선 'odd'를 출력하게 한다.



왼쪽에 if else 문은 여러 개를 사용할 수 있다. 그렇게 되면 elif와 같은 효과를 주게 된다.

```python
[i if i%2==0 else 'odd-1' if i==1 else 'odd-3'  for i in range(5)]

>>>[0, 'odd-1', 2, 'odd-3', 4]
```

i if i%2==0 : i가 2로 나누어 떨어지면 i를 그대로 출력

else 'odd-1' if i==1 : 2로 나누어 떨어지지 않으면, i가 1일 때 'odd-1' 출력

else 'odd-3' : 위의 두 조건이 모두 성립하지 않으면 'odd-3' 출력

i가 2로 나누어 떨어지면 그대로 출력하고, 1일 때는 'odd-1'을 출력하고 그렇지 않은 경우는 3밖에 남지 않으므로, 3일 때 'odd-3'이 출력된다.

#### 3. for문 2개 사용

```python
li=[]
for i in range(2):
    for j in range(3):
        li.append((i,j))
        
>>> [(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2)]
```

리스트 컴프리헨션을 이용하면 for문을 2개 사용함으로써 중첩 for문의 효과를 줄 수 있다.

```python
[(i,j) for i in range(2) for j in range(3)]

>>> [(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2)]
```

i가 0,1을 반복하며, 각각 j가 0~2를 반복하게 된다. 즉, i가 2번 반복되는 동안, j가 3번 반복되어 총 6가지가 출력된다. 출력되는 i, j에 대해서 괄호로 묶어야 정상 동작한다.



대괄호 대신 중괄호를 이용하면 집합 컴프리헨션(Set Comprehension)이 된다.

```python
{i for i in range(5)}

>>> {0, 1, 2, 3, 4}
```



이 때, 딕셔너리의 형식에 맞게 Key값과 Value를 콜론(":")을 사용하면 딕셔너리 컴프리헨션이 된다.

```python
{i:i for i in range(5)}

>>>{0: 0, 1: 1, 2: 2, 3: 3, 4: 4}
```



또한, 소괄호를 이용하면 Generator expression이 된다.